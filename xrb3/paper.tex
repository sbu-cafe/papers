\documentclass[preprint,times,tighten]{aastex631}

\usepackage{epsf,color,amsmath}

\usepackage{cancel}

\newcommand{\sfrac}[2]{\mathchoice%
  {\kern0em\raise.5ex\hbox{\the\scriptfont0 #1}\kern-.15em/
    \kern-.15em\lower.25ex\hbox{\the\scriptfont0 #2}}
  {\kern0em\raise.5ex\hbox{\the\scriptfont0 #1}\kern-.15em/
    \kern-.15em\lower.25ex\hbox{\the\scriptfont0 #2}}
  {\kern0em\raise.5ex\hbox{\the\scriptscriptfont0 #1}\kern-.2em/
    \kern-.15em\lower.25ex\hbox{\the\scriptscriptfont0 #2}} {#1\!/#2}}

\newcommand{\myhalf}{\sfrac{1}{2}}
\newcommand{\nph}{{n+\myhalf}}
\newcommand{\nmh}{{n-\myhalf}}

\newcommand{\inp}{\mathrm{in}}
\newcommand{\outp}{\mathrm{out}}

% boldsymbol means bold italic
\newcommand{\eb}{{\bf{e}}}
\newcommand{\Ub}{{\bf{U}}}
\newcommand{\xb}{{\bf{x}}}
\newcommand{\kb}{{\bf{k}}}
\newcommand{\Vb}{{\bf{V}}_n}
\newcommand{\Vbhat}{{\bf{\widehat{V}}}_n}
\newcommand{\Omegab}{{\bf{\Omega}}}
\newcommand{\gb}{{\bf{g}}}
\newcommand{\rb}{{\bf{r}}}

\newcommand{\pb}{p_\mathrm{base}}
\newcommand{\epsdot}{\dot{\epsilon}}
\newcommand{\qburn}{q_\mathrm{burn}}
\newcommand{\rt}{\tilde{r}_0}


\newcommand{\nablab}{\mathbf{\nabla}}
\newcommand{\dt}{\Delta\ t}

\newcommand{\omegadot}{\dot{\omega}}

\newcommand{\Hext}{H_{\rm ext}}
\newcommand{\Hnuc}{H_{\rm nuc}}
\newcommand{\kth}{k_{\rm th}}

\newcommand{\Gammaonebar}{\overline{\Gamma}_1}
\newcommand{\Sbar}{\overline{S}}

\newcommand{\etarho}{\eta_\rho}
\newcommand{\etarhoh}{\eta_{\rho~h}}

\newcommand{\Ubt}{\widetilde{\Ub}}
\newcommand{\wt}{\widetilde{w}}

\newcommand{\He}{$^4$He}
\newcommand{\C}{$^{12}$C}
\newcommand{\Fe}{$^{56}$Fe}

\newcommand{\isot}[2]{$^{#2}\mathrm{#1}$}
\newcommand{\isotm}[2]{{}^{#2}\mathrm{#1}}

\newcommand{\maestro}{{\sf MAESTRO}}
\newcommand{\castro}{{\sf Castro}}
\newcommand{\amrex}{{\sf AMReX}}
\newcommand{\pynucastro}{{\sf pynucastro}}

\newcommand{\avg}[1]{\overline{#1}}
\newcommand{\avgtwod}[1]{\langle~#1 \rangle}
\newcommand{\rms}[2]{\left(\delta#1\right)_{r_{#2}}}
\newcommand{\mymax}[1]{\left(#1\right)_{\rm max}}

\newcommand{\Tb}{\ensuremath{T_\mathrm{base}}}
\newcommand{\gcc}{\mathrm{g~cm^{-3} }}
\newcommand{\cms}{\mathrm{cm~s^{-1} }}

\newcommand{\half}{\frac{1}{2}}

\setlength{\marginparwidth}{0.5in}

\newcommand{\MarginPar}[1]{
    \marginpar{\vskip-\baselineskip%
               \raggedright%
               \tiny\sffamily%
               {\color{red}\hrule%
               \smallskip%
               #1\par%
               \smallskip%
               \hrule}}%
}

\newcommand{\AssignTo}[1]{
    \marginpar{\vskip-\baselineskip%
               \raggedright%
               \tiny\sffamily%
               {\color{blue}\hrule%
               \smallskip%
               #1\par%
               \smallskip%
               \hrule}}%
}

\begin{document}
%======================================================================
% Title
%======================================================================
\title{Dynamics of Laterally Propagating Flames in X-ray Bursts. III. Comparing Hotspot Evolution in Two and Three Dimensions}

\shorttitle{Lateral Flame Dynamics III}
%% \shortauthors{Harpole et al.}

%% \author[0000-0002-1530-781X]{Alice Harpole}
%% \affiliation{Dept.\ of Physics and Astronomy, Stony Brook University,
%%              Stony Brook, NY 11794-3800}

%% \author[0000-0001-6191-4285]{Kiran Eiden}
%% \affiliation{Dept.\ of Physics and Astronomy, Stony Brook University,
%%              Stony Brook, NY 11794-3800}

%% \author[0000-0001-8401-030X]{Michael Zingale}
%% \affiliation{Dept.\ of Physics and Astronomy, Stony Brook University,
%%              Stony Brook, NY 11794-3800}

%% \author[0000-0003-2300-5165]{Donald Willcox}
%% \affiliation{Lawrence Berkeley National Laboratory, Berkeley, CA}

%% \author{Yuri Cavecchi}
%% \affiliation{Mathematical Sciences and STAG Research Centre, University of Southampton, SO17 1BJ}

%% \author[0000-0003-0439-4556]{Max P.\ Katz}
%% \affiliation{NVIDIA Corp}

%% \author[0000-0001-8092-1974]{Weiqun Zhang}
%% \affiliation{Lawrence Berkeley National Laboratory, Berkeley, CA}


%% \correspondingauthor{Alice Harpole}
%% \email{alice.harpolee@stonybrook.edu}


%======================================================================
% Abstract and Keywords
%======================================================================
\begin{abstract}
We continue to investigate laterally propagating flames in XRBs,
comparing the early evolution and structure of a burning hotspot
between two- and three-dimensions.
\end{abstract}

\keywords{convection---hydrodynamics---methods: numerical---stars: neutron---X-rays: bursts}

%======================================================================
% Introduction
%======================================================================
\section{Introduction}\label{Sec:Introduction}

X-ray bursts result from thermonuclear burning of an accreted H/He or
He layer on a neutron star \citep{galloway:2017}.  Observations of
brightness oscillations in the rise of the lightcurve suggest that the
burning begins localized and then spreads across the neutron star.
One-dimensional simulations of X-ray bursts reproduce the lightcurve
and recurrence time \citep{woosley-xrb} and can use large reaction
networks to explore rp-process nucleosynthesis.

To understand how the burning front propagates across the surface, we
need to do multidimensional simulations.  The work of
\citet{cavecchi:2013,art-2015-cavecchi-etal,art-2016-cavecchi-etal}

The three-dimensional study by \citet{Cavecchi2019} showed...

We have been performing simulations of flame spreading on a neutron
star resolving the flame structure using realistic reaction networks.  Our two-dimensional studies \citep{eiden:2020,harpole:2021} demonstrated our open-source framework for modeling X-ray bursts using 

We use the \castro\ \citep{castro,castro_joss} simulation code, following
the same numerical approach described in \citet{eiden:2020,harpole:2021}.

%======================================================================
% Results
%======================================================================
\section{Simulations and Results}\label{Sec:results}

In \citet{harpole:2021}, we explored several different rotation rates
and initial model thermal structures.  We found that a model with a
neutron star crust temperature of $3\times 10^8~\mathrm{K}$ resulted
in a flame that accelerated quickly as it spread across the neutron
star surface.  We adopt this model for the 3D simulation presented
here, since it requires the least amount of simulation time to yield a
developed flame.  


Moving to 3D is very expensive, so to further reduce the computational
expense, we use a slightly lower resolution of 25 cm instead of 20 cm
from \citet{harpole:2021}.  We pick a rotation rate of 1000 Hz.
Because the hotspot is placed in the center of the domain, the size of
the domain also becomes a constraint, and as a result, the evolution
time we can reach will become limited by the time it takes the burning
to approach the edge of the domain.  As a result, we focus here on the
early evolution.

Our 3D simulation used a base grid of $1024^2 \times 128$ zones with 2
levels of refinement, the first jumping by a factor of 4 and the next
by a factor of 2.  The domain has a size $(2.048\times
10^5~\mathrm{cm})^2 \times 2.56\times 10^4~\mathrm{cm}$, giving a fine
grid resolution of $25~\mathrm{cm}$.  The initial model and other
simulation parameters are identical to those used in
\citet{harpole:2021}.  We used static mesh refinement, to achieve
better load balancing, fully refining the atmosphere below a height of
$3600~\mathrm{cm}$.  These simulations used the 7-isotope He-burning
network used in \citet{eiden:2020}.  The simulations were run on the
OLCF Summit supercomputer, on 342 to 1366 nodes, with 6 NVIDIA V100
GPUs per node.  The entire computation was offloaded to GPUs following
the strategy described in \citet{castro_gpu}.  Overall, about 370,000
node-hours were used for the calculation.  The full state of the
calculation was output only every 0.005 s, as each output file is 2.7 TB
in size (for single precision data).  We output a few fields more
frequently for visualization.  We ran a 2D simulation with the same
resolution and refinement strategy to compare with here.

Things to show:

Slice plot compared to 2-d simulation

Phase plot comparisons

Volume renderings

Because the 3D flame does not stay perfectly circular, it is difficult
to define the flame speed using the same method employed in
\citet{eiden:2020}.  Instead, we will look at the mass of the ash
material to assess how quickly the burning is taking place.
Figure~\ref{fig:mass_plot} shows the mass of the different species as
a function of time, for the 2D and 3D calculation.  The axisymmetric
2D calculation has slightly less volume than the 3D domain, since
rotating about the symmetry axis produces a cylindrical domain
inscribed in the 3D domain.  To compensate for this, we scale the
masses by the initial \isot{He}{4} mass.  This plot shows that the
masses of the heavy species , especially \isot{C}{12} and
\isot{Si}{28} grow quickly with time, but the 2D simulation appears to
burn faster than the 3D simulation.  This is because the assumption of
axisymmetry there does not allow for the complex structure we see in
the evolution of composition in the 3D flame.  This suggests that the
3D flame speed is slower than the 2D flame speed.

\begin{figure}[t]
\centering
\plotone{mass_plot}
\caption{\label{fig:mass_plot} Mass of species scaled to initial He mass as a function of time.  The 3D simulation is shown as the solid lines and the 2D simulation is shown as the dashed lines.}
\end{figure}

\section{Summary}

We have extended our simulation framework to three-dimensions, and
explored the differences between a two-dimensional axisymmetric
simulation and a fully three-dimensional hydrodynamical simulation.

The main limitation of this study is that computational resources
limited the size of the domain and resolution we could use.  To
improve simulations for the future, there are several avenues to
pursue.  First, the main expense of the current simulations is the
reaction network.  We need to work more on optimization of the
network.  Second, while additional resolution will be expensive, we
can go higher order, as demonstrated with the 4th order accurate
coupling of hydro, diffusion, and reactions in \cite{castro-sdc}.  The
main outstanding issue with applying that work to the present problem
is the multilevel time integration.

Future work will explore mixed H/He bursts, using this same framework.

\begin{acknowledgements}
\castro\ is open-source and freely available at
\url{http://github.com/AMReX-Astro/Castro}.  The problem setup used
here is available in the git repo as {\tt flame\_wave}.  The work at
Stony Brook was supported by DOE/Office of Nuclear Physics grant
DE-FG02-87ER40317.  This research used resources of the National
Energy Research Scientific Computing Center, a DOE Office of Science
User Facility supported by the Office of Science of the
U.~S.\ Department of Energy under Contract No.\ DE-AC02-05CH11231.
This research used resources of the Oak Ridge Leadership Computing
Facility at the Oak Ridge National Laboratory, which is supported by
the Office of Science of the U.S. Department of Energy under Contract
No. DE-AC05-00OR22725, awarded through the DOE INCITE program.  We
thank NVIDIA Corporation for the donation of a Titan X and Titan V GPU
through their academic grant program.  This research has made use of
NASA's Astrophysics Data System Bibliographic Services.
\end{acknowledgements}

\facilities{NERSC, OLCF}

\software{AMReX \citep{amrex_joss},
          Castro \citep{castro,castro_joss},
          GCC (\url{https://gcc.gnu.org/}),
          linux (\url{https://www.kernel.org/}),
          matplotlib (\citealt{Hunter:2007}, \url{http://matplotlib.org/}),
          NumPy \citep{numpy,numpy2},
          python (\url{https://www.python.org/}),
          valgrind \citep{valgrind},
          VODE \citep{vode},
          yt \citep{yt}}



%======================================================================
% References
%======================================================================

\bibliographystyle{aasjournal}
\bibliography{ws}


\end{document}
